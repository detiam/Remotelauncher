<!DOCTYPE html>

<head>
  <title>{{ program.name }}</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link
    rel="stylesheet"
    href="{{ url_for('static', filename='css/bootstrap.min.css') }}"
  />
  <script src="{{ url_for('static', filename='js/jquery-3.6.4.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
  <script>
    document.addEventListener('contextmenu', event => event.preventDefault());
    $(document).ready(function () {
      window.opener.location.reload();
      // 显示警告框
      $("#alert").fadeIn();
      // 定时隐藏警告框
      setTimeout(function () {
        $("#alert").fadeOut();
      }, 3000); // 设置5秒后自动隐藏
    });
  </script>
  <style>
    /* 添加红色边框样式 */
    .error {
      border: 2px solid red;
    }
  </style>
</head>

<html style="user-select: none;">
  <body>
    <div class="container">
      <button
        class="btn btn-block"
        type="button"
        data-toggle="collapse"
        data-target="#add-program"
        aria-expanded="false"
        aria-controls="add-program"
      >
        {{ _("Modify Settings") }}
      </button>
      <div class="collapse in" id="add-program">
        <br/>
        <form
          method="POST"
          action="{{ url_for('add_program', program_realid=program.id) }}"
        >
          <div class="row">
            <div class="form-group col-xs-4">
              <label for="program_id">{{ _("ID") }}:</label>
              <input
                type="number"
                max="2147483647"
                min="1"
                class="{% if alert %} error {% endif %} form-control"
                id="program_id"
                name="program_id"
                {% if alert %}
                value="{{ formerid }}"
                {% else %}
                value="{{ program.id }}"
                {% endif %}
                autocomplete="off"
                onclick="this.classList.remove('error')"
                required
              />
            </div>
            <div class="form-group col-xs-8">
              <label for="program_name">{{ _("Name") }}:</label>
              <input
                type="text"
                class="form-control"
                id="program_name"
                name="program_name"
                value="{{ program.name }}"
                autocomplete="off"
                required
              />
            </div>
          </div>
          <div class="form-group">
            <label for="program_workdir">{{ _("Working directory") }}:</label>
            <input
              type="text"
              class="form-control"
              id="program_workdir"
              name="program_workdir"
              value="{{ program.workdir }}"
              autocomplete="off"
            />
          </div>
          <div class="form-group">
            <label for="program_prefix"
              >{{ _("Prefix ( gamescope, mangohud, etc...)") }}:</label
            >
            <input
              type="text"
              class="form-control"
              id="program_prefix"
              name="program_prefix"
              value="{{ program.prefix }}"
              autocomplete="off"
            />
          </div>
          <div class="form-group">
            <label for="program_command">{{ _("Command") }}:</label>
            <input
              type="text"
              class="form-control"
              id="program_command"
              name="program_command"
              value="{{ program.command }}"
              autocomplete="off"
              required
            />
          </div>
          <center>
            {% if alert == '1' %}
            <div
              id="alert"
              style="position: fixed; z-index: 2; left: 30%; right: 30%"
              class="alert alert-danger"
              role="alert"
            >
              {{ _("ID already exists.") }}
            </div>
            {% elif alert == '2' %}
            <div
              id="alert"
              style="position: fixed; z-index: 2; left: 30%; right: 30%"
              class="alert alert-danger"
              role="alert"
            >
              {{ _("Data folder for {id} already exists.").format(id=formerid) }}
            </div>
            {% endif %}
            <button
              type="submit"
              style="position: relative; z-index: 1"
              class="btn btn-default"
            >
              {{ _("Save") }}
            </button>
          </center>
        </form>
      </div>
    </div>
  </body>
</html>
